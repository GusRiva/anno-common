[
  [
    {
      "collection": "test-collection"
    },
    true,
    "Allow everybody to do everything on 'test-collection'"
  ],
  [
    {
      "user.inactive": true
    },
    false,
    "Inactive users are not allowed to do anything"
  ],
  [
    {
      "method": {
        "$or": [
          "init",
          "aclCheck"
        ]
      }
    },
    true,
    "Allow store initialization and rights checks"
  ],
  [
    {
      "method": {
        "$or": [
          "get",
          "search"
        ]
      }
    },
    true,
    "Allow get and search by default"
  ],
  [
    {
      "user.role": "admin"
    },
    true,
    "Allow users with 'admin' role to do everything"
  ],
  [
    {
      "method": "delete"
    },
    false,
    "Disallowed delete"
  ],
  [
    {
      "method": {
        "$or": [
          "create",
          "revise"
        ]
      },
      "user.role": "moderator"
    },
    true,
    "Allow moderators to revise / reply to any annotations"
  ],
  [
    {
      "method": "create",
      "user.role": "create"
    },
    true,
    "Allow users with 'create' role to create new annotations"
  ],
  [
    {
      "method": {
        "$or": [
          "revise",
          "create"
        ]
      },
      "$or": [
        {
          "anno.creator": {
            "$ref": "/user"
          }
        },
        {
          "anno.creator.id": {
            "$ref": "/user"
          }
        },
        {
          "anno.creator": {
            "$ref": "/user/id"
          }
        },
        {
          "anno.creator.id": {
            "$ref": "/user/id"
          }
        }
      ]
    },
    true,
    "Allow users to revise and reply to their own annotations"
  ],
  [
    {},
    false,
    "Not authorized by acl rules"
  ]
]