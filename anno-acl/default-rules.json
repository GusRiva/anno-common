[
  [
    {
      "user.inactive": true
    },
    false,
    "Inactive users are not allowed to do anything"
  ],
  [
    {
      "collection": "test-collection"
    },
    true,
    "Allow everybody to do everything on 'test-collection'"
  ],
  [
    {
      "method": {
        "$or": [
          "get",
          "search",
          "searchRetrieve"
        ]
      }
    },
    true,
    "Allow get and search by default"
  ],
  [
    {
      "user.role": "admin"
    },
    true,
    "Allow users with 'admin' role to do everything"
  ],
  [
    {
      "method": {
        "$or": [
          "revise",
          "delete"
        ]
      },
      "user.perm": {
        "collection": {
          "$ref": "/collection"
        },
        "role": "moderator"
      }
    },
    true,
    "Allow moderators of a collection to revise and delete any annotations"
  ],
  [
    {
      "method": "create",
      "user.perm": {
        "collection": {
          "$ref": "/collection"
        },
        "role": "create"
      }
    },
    true,
    "Allow users with 'create' role in the collection to create new annotations"
  ],
  [
    {
      "method": {
        "$or": [
          "revise",
          "delete"
        ]
      },
      "$or": [
        {
          "anno.creator": {
            "$ref": "/user"
          }
        },
        {
          "anno.creator.id": {
            "$ref": "/user"
          }
        },
        {
          "anno.creator.email": {
            "$ref": "/user"
          }
        },
        {
          "anno.creator": {
            "$ref": "/user/id"
          }
        },
        {
          "anno.creator.id": {
            "$ref": "/user/id"
          }
        },
        {
          "anno.creator.email": {
            "$ref": "/user/id"
          }
        }
      ]
    },
    true,
    "Allow users to revise or delete their own annotations"
  ],
  [
    {},
    false,
    "Forbid by default"
  ]
]